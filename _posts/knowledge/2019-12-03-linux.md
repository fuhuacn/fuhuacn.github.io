---
layout: post
title: Linux
categories: Knowledge
description: Linux
keywords: Linux
---
[参考来源](https://github.com/CyC2018/CS-Notes/blob/master/notes/Linux.md)

# 一、常用概念及操作

## sudo

sudo 允许一般用户使用 root 可执行的命令，不过只有在 /etc/sudoers 配置文件中添加的用户才能使用该指令。

## 包管理工具

RPM 和 DPKG 为最常见的两类软件包管理工具：

+ RPM 全称为 Redhat Package Manager，最早由 Red Hat 公司制定实施，随后被 GNU 开源操作系统接受并成为许多 Linux 系统的既定软件标准。YUM 基于 RPM，具有依赖管理和软件升级功能。
+ 与 RPM 竞争的是基于 Debian 操作系统的 DEB 软件包管理工具 DPKG，全称为 Debian Package，功能方面与 RPM 相似。

## 发行版

| 基于的包管理工具 | 商业发行版 | 社区发行版 |
| :--: | :--: | :--: |
| RPM | Red Hat | Fedora / CentOS |
| DPKG | Ubuntu | Debian |

## vim 三个模式

+ 一般指令模式（Command mode）：VIM 的默认模式，可以用于移动游标查看内容；
+ 编辑模式（Insert mode）：按下 "i" 等按键之后进入，可以对文本进行编辑；
+ 指令列模式（Bottom-line mode）：按下 ":" 按键之后进入，用于保存退出等操作。

## GNU

GNU 计划，译为革奴计划，它的目标是创建一套完全自由的操作系统，称为 GNU，其内容软件完全以 GPL 方式发布。其中 GPL 全称为 GNU 通用公共许可协议（GNU General Public License），包含了以下内容：

+ 以任何目的运行此程序的自由；
+ 再复制的自由；
+ 改进此程序，并公开发布改进的自由。

# 磁盘

## 磁盘接口

M.2,U.2,AIC 是物理规格，像是 公路，铁路。

PCIe（比 SATA 快），SATA（最常用），SAS，IDE（最慢） 是 模拟高速接口，像是 县道，省道，高速这样。速率上限不同

SCSI，ATA，NVMe 是传输层协议，命令集。就是跑在路上面的小车，只是有 跑车 和 面包车 之分。

## 磁盘的文件名

Linux 中每个硬件都被当做一个文件，包括磁盘。磁盘以磁盘接口类型进行命名，常见磁盘的文件名如下：

+ IDE 磁盘：/dev/hd[a-d]
+ SATA/SCSI/SAS 磁盘：/dev/sd[a-p]

其中文件名后面的序号的确定与系统检测到磁盘的顺序有关，而与磁盘所插入的插槽位置无关。

# 三、分区

将一个磁盘分成多个区，可以挂载在多个目录下。

分区的好处：

+ 主要方面：只用一个分区，若遇到系统需要重装或者分区需要进行格式化等，原有的重要文件无法在本硬盘保留，而若提前进行了合理分区，则用户数据不会收到影响。
+ 次要方面：同等外部条件下，读取越频繁，磁盘越容易受损，我们把读写频繁的目录挂载到一个单独的分区，可以把磁盘的损伤控制在一个集中的区域。
+ 效率方面：分区将数据集中在某个磁柱的区段，当有数据要读取自该分区时，硬盘只会搜寻相应区段，有助于数据读取的速度与效能的提升！

## 分区表

磁盘分区表主要有两种格式，一种是限制较多的 MBR 分区表，一种是较新且限制较少的 GPT 分区表。

## 1. MBR

MBR 中，第一个扇区最重要，里面有主要开机记录（Master boot record, MBR）及分区表（partition table），其中主要开机记录占 446 bytes，分区表占 64 bytes。

分区表只有 64 bytes，最多只能存储 4 个分区，这 4 个分区为主分区（Primary）和扩展分区（Extended）。其中扩展分区只有一个，它使用其它扇区来记录额外的分区表，因此通过扩展分区可以分出更多分区，这些分区称为逻辑分区。

Linux 也把分区当成文件，分区文件的命名方式为：磁盘文件名 + 编号，例如 /dev/sda1。注意，逻辑分区的编号从 5 开始。

## 2. GPT

扇区是磁盘的最小存储单位，旧磁盘的扇区大小通常为 512 bytes，而最新的磁盘支持 4 k。GPT 为了兼容所有磁盘，在定义扇区上使用逻辑区块地址（Logical Block Address, LBA），LBA 默认大小为 512 bytes。

GPT 第 1 个区块记录了主要开机记录（MBR），紧接着是 33 个区块记录分区信息，并把最后的 33 个区块用于对分区信息进行备份。这 33 个区块第一个为 GPT 表头纪录，这个部份纪录了分区表本身的位置与大小和备份分区的位置，同时放置了分区表的校验码 (CRC32)，操作系统可以根据这个校验码来判断 GPT 是否正确。若有错误，可以使用备份分区进行恢复。

GPT 没有扩展分区概念，都是主分区，每个 LBA 可以分 4 个分区，因此总共可以分 4 * 32 = 128 个分区。

MBR 不支持 2.2 TB 以上的硬盘，GPT 则最多支持到 233 TB = 8 ZB。

![GPT](/images/posts/knowledge/linux/GPT.png)

## 开机检测程序

### 1. BIOS

BIOS（Basic Input/Output System，基本输入输出系统），它是一个固件（嵌入在硬件中的软件），BIOS 程序存放在断电后内容不会丢失的只读内存中。